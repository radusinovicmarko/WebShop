{
  "rules": [
    {
      "methods": ["POST"],
      "pattern": "/api/v1/auth/**",
      "roles": []
    },
    {
      "methods": ["POST"],
      "pattern": "/api/v1/products",
      "roles": ["RegisteredUser"]
    },
    {
      "methods": ["POST"],
      "pattern": "/api/v1/products/*/purchase",
      "roles": ["RegisteredUser"]
    },
    {
      "methods": ["DELETE"],
      "pattern": "/api/v1/products/*",
      "roles": ["RegisteredUser"]
    },
    {
      "methods": ["POST"],
      "pattern": "/api/v1/products/*/comments",
      "roles": ["RegisteredUser"]
    },
    {
      "methods": ["GET"],
      "pattern": "/api/v1/products*",
      "roles": []
    },
    {
      "methods": ["GET"],
      "pattern": "/api/v1/users/*?/purchases",
      "roles": ["RegisteredUser"]
    },
    {
      "methods": ["GET"],
      "pattern": "/api/v1/users/*?/messages",
      "roles": ["RegisteredUser"]
    },
    {
      "methods": ["GET"],
      "pattern": "/api/v1/users/*",
      "roles": []
    }
  ]
}